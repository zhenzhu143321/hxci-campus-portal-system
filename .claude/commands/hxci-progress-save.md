---
allowed-tools: TodoWrite, Edit, Read, Bash(git:*), Write
argument-hint: 工作描述和当前状态 [简短描述当前完成的工作内容]
description: 任务状态保存工作流 - TodoWrite更新和文档同步
model: claude-4-sonnet
---

# HXCI任务状态保存工作流 - 智能化状态管理

**工作描述**: $ARGUMENTS

## 当前工作状态收集

### Git版本状态
- 当前工作区状态: !`git status --porcelain`
- 暂存区内容: !`git diff --cached --name-only`
- 最新提交: !`git log --oneline -1`
- 分支状态: !`git branch -vv`

### 项目文件变更
- 最近修改的Java文件: !`find yudao-boot-mini -name "*.java" -mtime -1 -type f`
- 最近修改的Vue文件: !`find hxci-campus-portal -name "*.vue" -mtime -1 -type f` 
- 配置文件变更: !`git diff --name-only HEAD~1..HEAD`

### 系统运行状态
- 服务进程状态: !`netstat -tlnp`
- 最近编译状态: !`ls -la yudao-boot-mini/yudao-server/target/*.jar`

## TodoWrite任务状态同步

**执行TodoWrite更新**: 自动同步当前任务进度到TodoWrite系统

基于工作描述 "$ARGUMENTS" 和当前项目状态，智能更新任务列表：

### 任务状态分析
1. **已完成的工作**: 根据Git变更和文件修改时间分析完成的任务
2. **进行中的工作**: 基于工作描述确定当前active的任务  
3. **下一步计划**: 根据项目整体进度推测后续任务

### 自动状态更新
- 将相关已完成任务标记为 `completed`
- 更新当前工作任务为 `in_progress` 
- 调整任务优先级和描述信息
- 确保任务列表反映真实工作状态

## 项目状态文档更新

### CURRENT_WORK_STATUS.md 同步更新

**读取当前文档**: @CURRENT_WORK_STATUS.md

**智能文档更新**: 基于以下信息更新项目状态文档：

1. **工作进展更新**
   ```markdown
   ## [日期时间] 工作状态更新
   
   ### 本次完成工作
   - $ARGUMENTS - 完成时间: [当前时间]
   
   ### 技术实现详情
   [基于Git变更自动生成实现摘要]
   
   ### 遇到的问题和解决方案
   [如果有异常或警告，记录问题和解决过程]
   ```

2. **项目进度刷新**
   - 更新整体完成度百分比
   - 刷新各模块的状态标记
   - 调整预期完成时间

3. **技术决策记录**
   - 记录重要的架构选择和原因
   - 更新依赖变更和配置调整
   - 文档化重要的问题解决方案

## Git暂存和提交准备

### 智能文件暂存
基于工作内容自动识别需要暂存的文件：

- **核心代码文件**: 新增或修改的Java/Vue文件
- **配置更新**: yml/properties/json配置文件  
- **文档更新**: 自动包含更新的状态文档

### 提交信息准备
生成规范化的Git提交信息：

```bash
# 建议的提交信息格式：
git add [智能识别的文件列表]
git commit -m "🔧 $ARGUMENTS

## 主要变更
[基于文件分析生成的变更摘要]

## 技术细节  
[关键实现点和配置调整]

🤖 Generated with Claude Code - Status Auto-Saved"
```

**注意**: 遵循CLAUDE.md铁律，仅准备提交信息，不自动执行提交，等待用户确认

## 工作摘要报告生成

### 结构化工作总结

**本次工作摘要**:
- **完成功能**: $ARGUMENTS
- **涉及文件**: [自动统计修改文件数量和类型]  
- **代码行数**: [新增/修改/删除代码行统计]
- **测试状态**: [基于运行状态评估功能可用性]

**质量指标**:
- **编译状态**: ✅ 通过 / ❌ 存在问题
- **服务状态**: ✅ 正常运行 / ⚠️ 需要重启  
- **文档同步**: ✅ 已更新 / 📝 需要完善

**下一步建议**:
- 基于当前进度推荐下一个优先任务
- 提醒需要注意的技术风险点
- 建议的测试和验证步骤

### 知识传承记录

自动生成本次工作的关键信息，便于后续开发参考：

- **技术实现要点**: 关键代码逻辑和设计选择
- **配置变更清单**: 重要的配置修改和原因
- **调试经验**: 遇到的问题和解决方法
- **性能考虑**: 相关的性能优化措施

## 后续工作提醒

**推荐后续操作**:
1. 如需要继续开发: `/hxci-code-start [下一个模块]`
2. 如遇到技术问题: `/hxci-code-ask [具体问题]` 
3. 完成编码需要审查: `/hxci-code-done [文件/模块]`
4. 系统健康检查: `/hxci-health all`

**执行方式**: `/hxci-progress-save "P0安全权限缓存系统实施完成"`