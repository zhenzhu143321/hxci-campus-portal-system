# 🎭 全量功能演示HTML页面设计文档

> **目标**: 为Vue开发提供完整参考的傻瓜式演示页面
> **创建时间**: 2025-08-10
> **状态**: 设计阶段

## 🎯 核心设计理念

### **用户体验目标**：
- **傻瓜式操作**: 点击一个按钮就能看到完整功能演示
- **Vue开发参考**: 每个操作都显示对应的API调用详情
- **权限差异对比**: 直观展示不同角色的权限边界
- **完整业务流程**: 从登录到审批的端到端演示

## 🏗️ 页面布局设计

```
┌─────────────────────────────────────────────────────┐
│  🎭 顶部角色切换区 & 系统状态                        │
│  [校长] [教务主任] [教师] [班主任] [学生] [服务状态] │
├─────────────────┬───────────────────────────────────┤
│  📋 左侧操作面板 │        💻 右侧API详情区           │
│  ┌─────────────┐│  ┌─────────────────────────────┐  │
│  │ 🚀智能演示   ││  │ 📡 实时API调用信息           │  │
│  │ ─────────── ││  │ ┌─ 当前请求 ─┐              │  │
│  │[一键完整流程]││  │ │ POST /auth │              │  │
│  │[权限对比演示]││  │ │ Headers... │              │  │
│  │[审批流程演示]││  │ │ Body...    │              │  │
│  └─────────────┘│  │ └───────────┘              │  │
│  ┌─────────────┐│  │ ┌─ 响应结果 ─┐              │  │
│  │ 🎯分步操作   ││  │ │ 200 OK     │              │  │
│  │ ─────────── ││  │ │ Response...│              │  │
│  │[登录认证]    ││  │ └───────────┘              │  │
│  │[发布通知]    ││  └─────────────────────────────┘  │
│  │[查看列表]    ││  ┌─────────────────────────────┐  │
│  │[审批操作]    ││  │ 📊 API调用历史记录          │  │
│  │[权限测试]    ││  │ 1. POST /auth - 200 OK     │  │
│  └─────────────┘│  │ 2. POST /publish - 403     │  │
│                 │  │ 3. GET /list - 200 OK      │  │
│                 │  └─────────────────────────────┘  │
├─────────────────┴───────────────────────────────────┤
│  🎪 底部状态栏 & 演示进度追踪                        │
│  当前角色: 校长 | 当前操作: 发布1级通知 | 权限: ✅    │
└─────────────────────────────────────────────────────┘
```

## 🎭 五个角色完整演示矩阵

### **校长 (PRINCIPAL)**
- **发布权限**: 1-4级全权限 ✅✅✅✅
- **范围权限**: SCHOOL_WIDE + DEPARTMENT + CLASS + GRADE (4个)
- **审批权限**: 可审批所有待审批通知 ✅
- **演示重点**: 展示最高权限，审批流程的终端

### **教务主任 (ACADEMIC_ADMIN)**  
- **发布权限**: 2-4级权限 ❌✅✅✅ (1级需审批)
- **范围权限**: SCHOOL_WIDE + DEPARTMENT + GRADE (3个)
- **审批权限**: 无审批权限 ❌
- **演示重点**: 展示审批流程的起点，权限受限的管理员

### **教师 (TEACHER)**
- **发布权限**: 3-4级权限 ❌❌✅✅
- **范围权限**: DEPARTMENT + CLASS (2个)
- **审批权限**: 无审批权限 ❌
- **演示重点**: 展示普通教学人员的权限边界

### **班主任 (CLASS_TEACHER)**
- **发布权限**: 3-4级权限 ❌❌✅✅  
- **范围权限**: CLASS + GRADE (2个)
- **审批权限**: 无审批权限 ❌
- **演示重点**: 展示班级管理的特定权限

### **学生 (STUDENT)**
- **发布权限**: 4级权限 ❌❌❌✅
- **范围权限**: CLASS (1个)
- **审批权限**: 无审批权限 ❌
- **演示重点**: 展示最低权限用户的能力边界

## 🎪 智能演示模式设计

### **模式1: 完整业务流程演示**
```
[开始完整演示] 按钮触发：
1. 🔄 角色切换: 教务主任登录
2. 📝 发布1级通知 → 显示"需要审批"状态
3. 🔄 角色切换: 校长登录  
4. ✅ 查看待审批 → 批准通知
5. 🔄 角色切换: 学生登录
6. 📋 查看通知列表 → 显示已批准的通知
7. 📊 显示完整权限对比表
```

### **模式2: 权限边界对比演示**
```
[权限对比演示] 按钮触发：
┌─────────────────┬─────┬─────┬─────┬─────┐
│      功能       │校长 │教务 │教师 │学生 │
├─────────────────┼─────┼─────┼─────┼─────┤
│ 发布1级通知     │ ✅  │ 🔄  │ ❌  │ ❌  │
│ 发布2级通知     │ ✅  │ ✅  │ ❌  │ ❌  │  
│ 发布3级通知     │ ✅  │ ✅  │ ✅  │ ❌  │
│ 发布4级通知     │ ✅  │ ✅  │ ✅  │ ✅  │
│ 全校范围        │ ✅  │ ✅  │ ❌  │ ❌  │
│ 审批通知        │ ✅  │ ❌  │ ❌  │ ❌  │
└─────────────────┴─────┴─────┴─────┴─────┘
```

### **模式3: 审批流程追踪演示**
```
[审批流程演示] 按钮触发：
📊 流程可视化：
教务主任 → [发布1级通知] → 状态:PENDING_APPROVAL
    ↓
校长     → [查看待审批]   → 发现1条待审批
    ↓
校长     → [批准通知]     → 状态:APPROVED → PUBLISHED
    ↓
全部用户 → [查看通知列表] → 显示已发布通知
```

## 💻 API调用详情区设计

### **实时显示内容**：
1. **当前请求信息**
   - HTTP方法 + URL
   - 请求头 (特别是Authorization和tenant-id)
   - 请求体 (JSON格式化显示)

2. **响应结果信息**
   - 状态码 + 状态描述
   - 响应头
   - 响应体 (JSON格式化显示)
   - 执行时间

3. **API调用历史**
   - 最近10次API调用记录
   - 成功/失败状态标识
   - 可点击查看详情

### **特殊功能**：
- **代码生成**: 自动生成对应的Vue/JavaScript代码
- **错误诊断**: 当API调用失败时，显示可能的原因
- **性能监控**: 显示API响应时间

## 🎯 技术实现要点

### **关键技术选择**：
- **布局**: CSS Grid + Flexbox响应式布局
- **API调用**: fetch API + 错误处理
- **状态管理**: 简单的全局状态对象
- **代码高亮**: Prism.js或highlight.js
- **UI组件**: 原生HTML + 现代CSS (不引入框架)

### **核心交互逻辑**：
```javascript
// 核心演示状态
const demoState = {
    currentRole: 'PRINCIPAL',
    currentToken: '',
    apiHistory: [],
    demoMode: 'manual', // manual | auto | compare
    currentStep: 0
};

// 智能演示控制
const runFullDemo = async () => {
    await switchRole('ACADEMIC_ADMIN');
    await publishNotification(1, 'SCHOOL_WIDE');
    await switchRole('PRINCIPAL'); 
    await approveNotification();
    await switchRole('STUDENT');
    await viewNotificationList();
    showComparisonMatrix();
};
```

### **用户体验优化**：
- **操作反馈**: 每个按钮点击都有即时反馈
- **进度指示**: 智能演示模式显示当前进度
- **错误处理**: 友好的错误提示和恢复建议
- **响应式设计**: 适配不同屏幕尺寸

## 📋 开发计划

### **Phase 1: 基础框架搭建**
- 页面布局和样式
- 角色切换逻辑
- API调用基础框架

### **Phase 2: 核心功能实现**  
- 五个角色的登录认证
- 通知发布功能演示
- 通知列表查看演示

### **Phase 3: 高级功能实现**
- 审批流程演示
- 权限对比矩阵
- 智能演示模式
- 安全测试功能演示

### **Phase 4: 体验优化**
- API详情展示优化
- 代码生成功能
- 错误诊断和用户指导

## 📝 开发注意事项

1. **兼容性**: 确保在主流浏览器中正常工作
2. **性能**: 避免过多的DOM操作，使用文档片段
3. **可维护性**: 模块化代码结构，便于后续修改
4. **用户体验**: 加载状态、错误状态的友好提示
5. **Vue参考价值**: 每个功能都要考虑Vue开发者的需求

## 🛡️ 安全功能演示设计

### **安全测试功能展示区域**：
```
┌─ 🛡️ 安全功能测试区 ─┐
│ [综合安全测试]        │ → POST /api/security-test
│ [SQL注入防护测试]     │ → POST /api/sql-injection-test  
│ [输入验证演示]        │ → 展示恶意输入拦截
│ [HTML转义演示]       │ → 展示XSS攻击防护
│ [安全审计日志]        │ → 展示安全事件记录
└─────────────────────┘
```

### **安全测试演示内容**：

#### **1. 综合安全测试演示**
```javascript
// 自动触发安全功能全面测试
{
  "title": "Security Test <script>alert('xss')</script>",
  "content": "'; DROP TABLE users; --",
  "level": 3
}
```
**展示结果**：
- 输入验证：❌ 检测到恶意脚本
- HTML转义：✅ 脚本标签已转义
- SQL安全：❌ 检测到SQL注入尝试
- 审计日志：✅ 安全事件已记录

#### **2. SQL注入防护测试演示**
```javascript
// 展示常见SQL注入攻击模式的防护
const maliciousInputs = [
  "'; DROP TABLE notification_info; --",
  "1' OR '1'='1",
  "admin'; DELETE FROM system_users; --",
  "1' UNION SELECT * FROM system_users --"
];
```

#### **3. 安全测试权限矩阵**
```
┌─────────────────┬─────┬─────┬─────┬─────┐
│   安全测试功能   │校长 │教务 │教师 │学生 │
├─────────────────┼─────┼─────┼─────┼─────┤
│ 执行安全测试     │ ✅  │ ✅  │ ✅  │ ✅  │
│ 查看安全日志     │ ✅  │ ✅  │ ❌  │ ❌  │
│ SQL注入测试     │ ✅  │ ✅  │ ✅  │ ✅  │
│ 恶意输入测试     │ ✅  │ ✅  │ ✅  │ ✅  │
└─────────────────┴─────┴─────┴─────┴─────┘
```

### **安全演示智能模式**：
```
[安全防护演示] 按钮触发：
1. 🔍 发送恶意输入 → 展示输入验证拦截
2. 🛡️ XSS攻击尝试 → 展示HTML转义防护  
3. 💉 SQL注入尝试 → 展示参数化查询防护
4. 📊 查看安全日志 → 展示审计记录功能
5. ✅ 显示安全测试通过报告
```

### **API调用展示重点**：
- **安全测试API**：`POST /admin-api/test/notification/api/security-test`
- **SQL注入测试API**：`POST /admin-api/test/notification/api/sql-injection-test`  
- **请求体示例**：包含各种恶意输入测试用例
- **响应分析**：详细的安全检测结果和防护状态
- **错误处理**：安全验证失败时的友好提示

---

> **重要**: 此文档在开发完成后需要删除，避免项目文档污染